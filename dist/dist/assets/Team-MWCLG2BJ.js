import{r,u as z,d as j,A as i,j as e,l as N,m as O,D as R,B as w}from"./index-CrC78F0C.js";import{P as $,C as V,a as Y,E as q,u as m,w as G,b as H}from"./jspdf.plugin.autotable-BYFa8mm3.js";import{E as J}from"./pencil-DAlNEmyY.js";import"./index-wcn2dDzh.js";import"./typeof-QjJsDpFa.js";const K=`si,fname,email,lname,phone,dob,designation,type,password
1,john,admin12@gmail.com,doe,9784561230,11-25-2024,1,free,Admin@123`,te=({permissions:a})=>{const C=a==null?void 0:a.includes("create"),D=a==null?void 0:a.includes("edit"),y=a==null?void 0:a.includes("delete");a==null||a.includes("download"),a==null||a.includes("view");const[n,k]=r.useState([]),[x,h]=r.useState(!1),[v,S]=r.useState(""),[E,b]=r.useState(null),[p,u]=r.useState("Bulk Upload"),c=r.useRef(null),f=z();r.useEffect(()=>{g()},[x]);const g=async()=>{try{const s=(await j.get(`${i}/api/getadmin`)).data.user;k(s)}catch(t){console.log(t)}},T=t=>{S(`${i}/api/deleteadmin/${t}`),h(!0)},U=()=>{h(!1)},_=()=>{f("/addteam")},F=t=>{b(t.target.files[0]),u("Upload")},P=()=>{p==="Bulk Upload"?c.current&&c.current.click():A(E)},A=async t=>{try{const s=new FormData;s.append("file",t),(await j.post(`${i}/api/adminuploadcsv`,s,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(u("Bulk Upload"),b(null),g(),w.success("Data Uploaded Successfully")):w.error("Data failed to Upload")}catch(s){console.log(s)}},B=t=>{const s=new Blob([t],{type:"text/csv"}),o=URL.createObjectURL(s),l=document.createElement("a");l.href=o,l.download="SMC bulkupload_template Team.csv",l.click(),URL.revokeObjectURL(o)},M=()=>{B(K)},d=()=>n.map(t=>({"User Id":t._id,"First Name":t.fname,"Last Name":t.lname,Email:t.email,Phone:t.phone,DOB:N(t.dob),Designation:t.designation})),L=()=>{const t=m.json_to_sheet(d()),s=[{wpx:180},{wpx:100},{wpx:100},{wpx:180},{wpx:80},{wpx:80},{wpx:80}];t["!cols"]=s;const o=m.book_new();m.book_append_sheet(o,t,"Teams"),G(o,"SMC_teams.xlsx")},I=()=>{const t=new H,s=["User Id","First Name","Last Name","Email","Phone","DOB","Designation"],o=d().map(l=>[l["User Id"],l["First Name"],l["Last Name"],l.Email,l.Phone,l.DOB,l.Designation]);t.autoTable({head:[s],body:o,startY:20,theme:"grid",headStyles:{fillColor:[97,144,213],textColor:[255,255,255],fontStyle:"bold",halign:"center"},bodyStyles:{textColor:[0,0,0],halign:"center"}}),t.save("SMC_teams.pdf")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-extralight",children:[e.jsxs("div",{className:"flex justify-between items-center my-2 ",children:[e.jsx("p",{className:" mx-2 mt-6",children:"Team"}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsx("button",{onClick:I,children:e.jsx("img",{className:" size-8",src:$,alt:"Pdf image"})}),e.jsx(V,{data:d(),filename:"SMC_teams.csv",className:"cursor-pointer",target:"_blank",children:e.jsx("img",{className:"size-8",src:Y,alt:"csv image"})}),e.jsx("button",{onClick:L,children:e.jsx("img",{className:" size-8",src:q,alt:"excel image"})}),e.jsxs("div",{className:" flex mx-3 space-x-6",children:[e.jsx("button",{onClick:M,className:"bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] text-nowrap py-1 lg:px-4 md:px-4 px-1",children:"CSV Template"}),e.jsxs("button",{onClick:P,className:"bg-white text-nowrap text-black py-1 lg:px-4 md:px-4 px-1",children:[p,e.jsx("input",{type:"file",ref:c,onChange:F,className:"hidden"})]}),C&&e.jsx("button",{onClick:_,className:"bg-gradient-to-r from-[#3D03FA] to-[#A71CD2]  text-nowrap py-1 lg:px-4 md:px-4 px-1  ",children:"Add team"})]})]})]}),e.jsx("div",{className:"mx-1 overflow-auto no-scrollbar ",children:e.jsxs("table",{className:" w-full",children:[e.jsx("thead",{className:"text-slate-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 font-extralight border border-slate-400",children:"User Id"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"First Name"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"Last Name"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Email"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Phone"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"DOB"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Designation"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Action"})]})}),e.jsx("tbody",{className:"text-slate-400 ",children:n&&n.map((t,s)=>e.jsxs("tr",{className:" text-nowrap text-center",children:[e.jsx("td",{className:"border border-slate-400 ",children:t._id}),e.jsx("td",{className:"border border-slate-400 capitalize",children:t.fname}),e.jsx("td",{className:"border border-slate-400 captialize",children:t.lname}),e.jsx("td",{className:"border border-slate-400",children:t.email}),e.jsx("td",{className:"border border-slate-400",children:t.phone}),e.jsx("td",{className:"border border-slate-400",children:N(t.dob)}),e.jsx("td",{className:"border border-slate-400 ",children:t.designation}),e.jsxs("td",{className:" border-b border-r border-slate-400 flex justify-around items-center  ",children:[D&&e.jsx("p",{onClick:()=>f("/editteam",{state:{userId:t._id}}),className:" cursor-pointer p-1  text-green-600 ",children:e.jsx("img",{className:"size-6",src:J,alt:"edit image"})}),y&&e.jsx("p",{onClick:()=>{T(t._id)},className:"cursor-pointer size-6",children:e.jsx("img",{src:O,alt:"delete image"})})]})]},s))})]})})]}),x&&e.jsx(R,{onClose:U,title:"team",onDelete:v})]})};export{te as default};
