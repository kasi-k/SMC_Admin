import{r as o,u as O,d as N,A as i,j as e,l as w,m as R,D as T,B as x}from"./index-CrC78F0C.js";import{P as $,C as V,a as Y,E as q,u as m,w as G,b as H}from"./jspdf.plugin.autotable-BYFa8mm3.js";import{E as J}from"./pencil-DAlNEmyY.js";import"./index-wcn2dDzh.js";import"./typeof-QjJsDpFa.js";const K=`si,fname,email,lname,phone,dob,type,company
1,john,user20@gmail.com,doe,9784561230,11-25-2024,free,seenit`,te=({permissions:s})=>{const C=s==null?void 0:s.includes("create"),y=s==null?void 0:s.includes("edit"),k=s==null?void 0:s.includes("delete");s==null||s.includes("download"),s==null||s.includes("view");const[c,D]=o.useState([]),[h,u]=o.useState(!1),[S,U]=o.useState(""),[v,p]=o.useState(null),[b,f]=o.useState("Bulk Upload"),n=o.useRef(null);localStorage.getItem("plan"),localStorage.getItem("courses");const j=O();o.useEffect(()=>{g()},[h]);const g=async()=>{try{const l=(await N.get(`${i}/api/getusers`)).data.user;D(l)}catch(t){console.log(t)}},E=t=>{U(`${i}/api/deleteuser?id=${t}`),u(!0)},P=()=>{u(!1)},F=()=>{j("/adduser")},_=t=>{p(t.target.files[0]),f("Upload")},B=()=>{b==="Bulk Upload"?n.current&&n.current.click():I(v)},I=async t=>{try{const l=new FormData;l.append("file",t),(await N.post(`${i}/api/useruploadcsv`,l,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(x.success("File uploaded successfully"),f("Bulk Upload"),p(null),g(),x.success("Data Uploaded Successfully")):x.error("Data failed to Upload")}catch(l){console.log(l)}},A=t=>{const l=new Blob([t],{type:"text/csv"}),r=URL.createObjectURL(l),a=document.createElement("a");a.href=r,a.download="bulkupload_template.csv",a.click(),URL.revokeObjectURL(r)},L=()=>{A(K)},d=()=>c.map(t=>({"User Id":t._id,"First Name":t.fname,"Last Name":t.lname,Email:t.email,Phone:t.phone,DOB:w(t.dob),Plan:t.type})),M=()=>{const t=m.json_to_sheet(d()),l=[{wpx:100},{wpx:100},{wpx:100},{wpx:180},{wpx:100},{wpx:80},{wpx:80},{wpx:80},{wpx:100}];t["!cols"]=l;const r=m.book_new();m.book_append_sheet(r,t,"Users"),G(r,"SMC_users.xlsx")},z=()=>{const t=new H,l=["User Id","First Name","Last Name","Email","Phone","DOB","Plan","Courses","Subscription Date"],r=d().map(a=>[a["User Id"],a["First Name"],a["Last Name"],a.Email,a.Phone,a.DOB,a.Plan,a.Courses,a["Subscription Date"]]);t.autoTable({head:[l],body:r,startY:20,theme:"grid",headStyles:{fillColor:[97,144,213],textColor:[255,255,255],fontStyle:"bold",halign:"center"},bodyStyles:{textColor:[0,0,0],halign:"center"}}),t.save("SMC_users.pdf")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-extralight",children:[e.jsxs("div",{className:"flex justify-between items-center my-2 ",children:[e.jsx("p",{className:"mx-2 mt-6",children:"User"}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsx("button",{onClick:z,children:e.jsx("img",{className:"size-8",src:$,alt:"Pdf image"})}),e.jsx(V,{data:d(),filename:"SMC_users.csv",className:"cursor-pointer",target:"_blank",children:e.jsx("img",{className:"size-8",src:Y,alt:"csv image"})}),e.jsx("button",{onClick:M,children:e.jsx("img",{className:"size-8",src:q,alt:"excel image"})}),e.jsxs("div",{className:"flex mx-3 space-x-6",children:[e.jsx("button",{onClick:L,className:"bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] text-nowrap py-1 lg:px-4 md:px-4 px-1",children:"CSV Template"}),e.jsxs("button",{onClick:B,className:"bg-white text-nowrap text-black py-1 lg:px-4 md:px-4 px-1",children:[b,e.jsx("input",{type:"file",ref:n,onChange:_,className:"hidden"})]}),C&&e.jsx("button",{onClick:F,className:"bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] text-nowrap py-1 lg:px-4 md:px-4 px-1",children:"Add user"})]})]})]}),e.jsx("div",{className:"mx-1 overflow-auto no-scrollbar ",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"text-nowrap text-slate-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 font-extralight border border-slate-400",children:"User Id"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"First Name"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"Last Name"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Email"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Phone"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"DOB"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Plan"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Action"})]})}),e.jsx("tbody",{className:"text-slate-400 ",children:c&&c.map((t,l)=>e.jsxs("tr",{className:"text-nowrap text-center",children:[e.jsx("td",{className:"border border-slate-400",children:t._id}),e.jsx("td",{className:"border border-slate-400 capitalize",children:t.fname}),e.jsx("td",{className:"border border-slate-400 capitalize",children:t.lname}),e.jsx("td",{className:"border border-slate-400",children:t.email}),e.jsx("td",{className:"border border-slate-400",children:t.phone}),e.jsx("td",{className:"border border-slate-400",children:w(t.dob)}),e.jsx("td",{className:"border border-slate-400",children:t.type}),e.jsxs("td",{className:"border-b border-r border-slate-400 flex justify-around items-center",children:[y&&e.jsx("p",{onClick:()=>j("/edituser",{state:{userId:t._id}}),className:"cursor-pointer mx-1 p-1 text-green-600",children:e.jsx("img",{className:"size-6",src:J,alt:"edit image"})}),k&&e.jsx("p",{onClick:()=>{E(t._id)},className:"cursor-pointer",children:e.jsx("img",{className:"size-6 my-1",src:R,alt:"delete image"})})]})]},l))})]})})]}),h&&e.jsx(T,{onClose:P,title:"user",onDelete:S})]})};export{te as default};
