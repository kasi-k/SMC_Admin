import{r as c,v as S,w as T,x as P,y as A,z as L,E as U,H as D,I as E,J as F,k as I,u as $,d as x,A as h,j as l,B as G}from"./index-BzYBcspH.js";const z=({onClose:H})=>{var b,g;const[d,m]=c.useState(""),[r,C]=c.useState([{name:"Dashboard",icon:S,value:"dashboard",permissions:[{label:"Total Courses Generated",value:"totalcourse"},{label:"Total No Of Users",value:"totalusers"},{label:"Revenue Generated",value:"totalrevenue"},{label:"Course Type",value:"coursetype"},{label:"Subscriptions",value:"subscription"},{label:"Recurring Revenue",value:"recurringrevenue"},{label:"Ticket Status",value:"ticketstatus"},{label:"Monthly Activity Progress",value:"monthlyProgress"},{label:"Revenue",value:"revenue"}]},{name:"Packages",icon:T,value:"packages",permissions:[{label:"Can view Packages",value:"view"},{label:"Can add Packages",value:"add"},{label:"Can edit Packages",value:"edit"},{label:"Can delete Packages",value:"delete"}]},{name:"Courses",icon:P,value:"courses",permissions:[{label:"Can view Courses",value:"view"},{label:"Can Generate Courses",value:"create"},{label:"Can delete Courses",value:"delete"}]},{name:"Subscriptions",icon:A,value:"subscription",permissions:[{label:"Can view Subscriptions",value:"view"}]},{name:"Users",icon:L,value:"users",permissions:[{label:"Can View Users",value:"view"},{label:"Can add Users",value:"create"},{label:"Can Edit Users",value:"edit"},{label:"Can Delete Users",value:"delete"}]},{name:"Team",icon:U,value:"team",permissions:[{label:"Can View Team",value:"view"},{label:"Can add Team",value:"create"},{label:"Can Edit Team",value:"edit"},{label:"Can Delete Team",value:"delete"}]},{name:"Help & Support",icon:D,value:"support",permissions:[{label:"Can view Tickets",value:"view"},{label:"Can assign Tickets",value:"assign"},{label:"Can reply to all tickets",value:"reply"},{label:"Can reply to self tickets",value:"self"}]},{name:"Reports",icon:E,value:"report",permissions:[{label:"Can view Reports",value:"view"},{label:"Can Download Reports",value:"download"}]},{name:"Settings",icon:F,value:"setting",permissions:[{label:"Roles & permission",value:"roles"},{label:"Taxes",value:"tax"},{label:"Help & Support",value:"support"}]}]),[o,i]=c.useState([]),[V,w]=c.useState([]),p=I(),u=(b=p.state)==null?void 0:b.roleId,f=(g=p.state)==null?void 0:g.role,y=$();c.useEffect(()=>{u&&k()},[u]);const k=async()=>{try{const s=(await x.get(`${h}/api/getrolebyid?role_name=${u}`)).data.role;m(s.role_name),i(s.accessLevels),w(s.accessLevels)}catch(e){console.log(e)}},j=e=>{const s=[...r];s[e].checked=!s[e].checked,C(s);const a=s[e].value;s[e].checked?i(t=>{const n={feature:a,permissions:s[e].permissions.map(v=>v.value)};return[...t,n]}):i(o.filter(t=>t.feature!==a))},N=(e,s)=>{const a=[...o],t=a.findIndex(n=>n.feature===r[e].value);if(t!==-1){const n=a[t].permissions.indexOf(s);n!==-1?a[t].permissions.splice(n,1):a[t].permissions.push(s),i(a)}},R=async()=>{const e={role_name:d,accessLevels:o,status:"active"};try{(await x.put(`${h}/api/update/${f}`,e)).status===200&&(y("/setting"),window.location.reload(),G.success("Role Updated Successfully"))}catch(s){console.log(s)}};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-[#000928] mx-3 my-2 py-3",children:l.jsxs("div",{className:"mb-2 mx-6",children:[l.jsx("h3",{className:"my-2 text-base text-white",children:"Role Name:"}),l.jsx("input",{type:"text",value:d,onChange:e=>m(e.target.value),className:"py-1 mb-5 rounded-md text-center text-black w-3/4"}),r.map((e,s)=>l.jsxs("div",{className:"grid mb-3 text-base",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("label",{className:"flex items-center gap-2 w-3/6",children:[l.jsx("img",{className:"size-5",src:e.icon,alt:"icons"}),e.name]}),l.jsx("input",{type:"checkbox",checked:o.some(a=>a.feature===e.value),onChange:()=>j(s)})]}),o.some(a=>a.feature===e.value)&&l.jsx("div",{className:"grid mx-6",children:e.permissions.map((a,t)=>{var n;return l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm w-4/6",children:a.label}),l.jsx("input",{type:"checkbox",value:a.value,checked:((n=o.find(v=>v.feature===e.value))==null?void 0:n.permissions.includes(a.value))||!1,onChange:()=>N(s,a.value)})]},t)})})]},s))]})}),l.jsx("div",{className:"flex justify-center my-8",children:l.jsx("button",{className:"text-lg bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] w-1/2 py-1.5",onClick:R,children:"Save"})})]})};export{z as default};
